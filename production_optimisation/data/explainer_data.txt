

The current flow is a follows:

data_reader is the starting point for reading
    - It creates a ExcelFile during initialisation with the help of the input in data_reader (path and filename)
    - When the 'read_all_dataframes' method is called then a list of Dataframe's is made and returned.

data_cleaner is the starting point for cleaning
    - It uses the individual functions defined in dataframe_cleaner to make functions that clean specific Dataframes.
    
dataframe_cleaner is the starting point for cleaning
    - This class is a grouping of all individual functions that can clean a Dataframe.
    - These functions are used in data_df_cleaner to make a cleaning process for individual dataframes.


# Reading the helper_read_sheets: 'read1'
read1 = Data_Reader('EW_init', path_to_excel)

read1.read_all_dataframes(df_reader_helper)
dataframes_read1 = Dataframes(dataframes=read1.get_dataframes())

helper_read_dfs = all_dataframes.get('helper_read_dfs') # Change to input variable 'name_of_helper_read_dfs_in_Dictionary' when creating a function for this.
helper_read_sheets_df = dataframes_read1.get_dataframe_by_name(helper_read_dfs)

dataframes_read1.clean_dataframes(helper_read_sheets_df)

sheets_to_read = read1.get_sheets_to_read(helper_read_sheets_df)


print('********************')


# Reading all the informative sheets: 'read2'
# Needs helper_read_sheets_df from READ1
read2 = Data_Reader('EW', path_to_excel)

read2.read_all_dataframes(sheets_to_read)
dataframes = read2.get_dataframes()

for df in dataframes:
    Data_Cleaner(df).clean_dfs(helper_read_sheets_df)


dataframes_read2 = Dataframes(dataframes=dataframes)

print("********************")

#FIXME: Dictionary: Create a dictionary that 'applies' both, then this can probably be moved to a 'build_all()' function, instead of calling individually.
Data_Builder(dataframes_read2).build_new_df_column_based(all_dataframes.get('time_req_df'), 'time') 
Data_Builder(dataframes_read2).build_new_df_column_based(all_dataframes.get('specific_line_df'), 'specific_line')
Data_Builder(dataframes_read2).build_new_df_column_based(all_dataframes.get('dates_df'), 'dates')
Data_Builder(dataframes_read2).build_new_df_column_based(all_dataframes.get('suborders_df'), 'next_prev_suborder')
Data_Builder(dataframes_read2).build_new_df_column_based(all_dataframes.get('revenue_df'), 'revenue')

print("********************")
Data_Builder(dataframes_read2).build_penalty_df()